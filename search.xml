<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[PowerShell设置代理链接]]></title>
    <url>%2F2019%2F02%2F13%2FPowerShell%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86%E9%93%BE%E6%8E%A5%2F</url>
    <content type="text"><![CDATA[Windows PowerShell代理链接这是一段从Microsoft官方下载的脚本,慎重使用 &lt;# .Synopsis This function will set the proxy settings provided as input to the cmdlet. .Description This function will set the proxy server and (optinal) Automatic configuration script. .Parameter ProxyServer This parameter is set as the proxy for the system. Data from. This parameter is Mandatory .Example Setting proxy information Set-InternetProxy -proxy &quot;proxy:7890&quot; .Example Setting proxy information and (optinal) Automatic Configuration Script Set-InternetProxy -proxy &quot;proxy:7890&quot; -acs &quot;http://proxy:7892&quot; #&gt; Function Set-InternetProxy { [CmdletBinding()] Param ( [Parameter(Mandatory=$True,ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true)] [String[]]$Proxy, [Parameter(Mandatory=$False,ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true)] [AllowEmptyString()] [String[]]$acs ) Begin { $regKey=&quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot; } Process { Set-ItemProperty -path $regKey ProxyEnable -value 1 Set-ItemProperty -path $regKey ProxyServer -value $proxy if($acs) { Set-ItemProperty -path $regKey AutoConfigURL -Value $acs } } End { Write-Output &quot;Proxy is now enabled&quot; Write-Output &quot;Proxy Server : $proxy&quot; if ($acs) { Write-Output &quot;Automatic Configuration Script : $acs&quot; } else { Write-Output &quot;Automatic Configuration Script : Not Defined&quot; } } } 将上面的代码复制下来并保存为Set-InternetProxy.ps1即可。]]></content>
      <categories>
        <category>SS/SSR</category>
      </categories>
  </entry>
</search>
