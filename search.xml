<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>PowerShell设置代理链接</title>
      <link href="/2019/02/13/PowerShell%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86%E9%93%BE%E6%8E%A5/"/>
      <url>/2019/02/13/PowerShell%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86%E9%93%BE%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><a id="more"></a><p><img src="https://i.loli.net/2019/02/13/5c63c615cca99.png" alt="PowerShell.png"></p><h1 id="Windows-PowerShell代理链接"><a href="#Windows-PowerShell代理链接" class="headerlink" title="Windows PowerShell代理链接"></a>Windows PowerShell代理链接</h1><p>这是一段从Microsoft官方下载的脚本,慎重使用<code></code></p><pre><code>&lt;#.SynopsisThis function will set the proxy settings provided as input to the cmdlet..DescriptionThis function will set the proxy server and (optinal) Automatic configuration script..Parameter ProxyServerThis parameter is set as the proxy for the system.Data from. This parameter is Mandatory.ExampleSetting proxy informationSet-InternetProxy -proxy &quot;proxy:7890&quot;.ExampleSetting proxy information and (optinal) Automatic Configuration Script Set-InternetProxy -proxy &quot;proxy:7890&quot; -acs &quot;http://proxy:7892&quot;#&gt;Function Set-InternetProxy{    [CmdletBinding()]    Param    (        [Parameter(Mandatory=$True,ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true)]        [String[]]$Proxy,        [Parameter(Mandatory=$False,ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true)]        [AllowEmptyString()]        [String[]]$acs                    )    Begin    {            $regKey=&quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;            }    Process    {                Set-ItemProperty -path $regKey ProxyEnable -value 1        Set-ItemProperty -path $regKey ProxyServer -value $proxy                                    if($acs)         {                                         Set-ItemProperty -path $regKey AutoConfigURL -Value $acs           }    }     End    {        Write-Output &quot;Proxy is now enabled&quot;        Write-Output &quot;Proxy Server : $proxy&quot;        if ($acs)        {                        Write-Output &quot;Automatic Configuration Script : $acs&quot;        }        else        {                        Write-Output &quot;Automatic Configuration Script : Not Defined&quot;        }    }}</code></pre><p>将上面的代码复制下来并保存为<strong>Set-InternetProxy.ps1</strong>即可。</p>]]></content>
      
      
      <categories>
          
          <category> SS/SSR </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
